<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>
    Modern Developer :: HTML & CSS Project Assignment - Scheduling
  </title>
  <meta name="description" 
        content="Modern Developer :: HTML & CSS Project Assignment - Scheduling">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" 
        href="https://fonts.googleapis.com/css?family=Raleway:400,300italic">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/showcase.css">
  <link rel="stylesheet" href="css/topBar.css">
  <link rel="stylesheet" href="css/project_4_scheduling.css">  
</head>
<body>

  <header class="topbar" role="banner">
    <nav class="topbar__nav" role="navigation">
      <ul class="topbar__nav__list">
        <li class="nav__list__item nav__list__item--home">
          <a class="nav__link" href="index.html" title="Home Page">
            &#8962; Home
          </a>
        </li>        
        <li class="nav__list__item">
          <a  class="nav__link" 
              href="project_4_creditCard.html" 
              title="Next Project">
            Next Project &#8680;
          </a>
        </li>
      </ul>
      <p class="topbar__nav__title">4: Scheduling</p>
    </nav>
  </header>
    
    <!-- PROJECT CONTENT -->

  <div class="scheduling">
    <header class="scheduling__header">
      <h2>Schedule an event</h2>
      <ol class="crumb">
        <li class="crumb__item">
          <a class="crumb__link crumb__link--active active" href="#">
            General
          </a>
        </li>
        <li class="crumb__item">
          <a class="crumb__link" href="#">
            Time proposal
          </a>
        </li>
        <li class="crumb__item">
          <a class="crumb__link" href="#">
            Invite
          </a>
        </li>
      </ol>
    </header>
  <section class="schedule__module">
    <header class="schedule__module__header">
      <picture>
        <img class="header_picture"
             src="images/calendar.png" 
             width="64" 
             height="64" 
             alt="Event Schedule">
      </picture>
      <h2 class="header__heading">Event details</h2>
    </header>
      <form class="schedule__form" id="scheduleForm" name="scheduleForm" 
            action="" method="">
        <p id="evtNameBox">
          <label class="schedule__label
                        schedule__label--required" 
                 for="evtName">Event Name
          </label>
          <input class="schedule__input
                        schedule__input--evtName"
                 id="evtName"
                 name="evtName"
                 type="text"
                 required>
        </p>
        <label class="schedule__label 
                      schedule__label--required" 
               for="date">Date MM/GG/YY
        </label>
        <input class="schedule__input" 
               id="date"
               name="date"
               type="text" required>
        <label class="schedule__label
                      schedule__label--required" 
               for="time">Time HH:MM
        </label>
        <input class="schedule__input" type="text" id="time" name="time">
        <label class="schedule__label
                      schedule__label--required"
               for="timezone">Timezone
        </label>
        <select class="schedule__select" name="timezone" id="timezone" required>
          <option value="">Select</option>
          <option value="1">Time Zone 1</option>
          <option value="2">Time Zone 2</option>
        </select>
        <label class="schedule__label" for="message">Message</label>
        <textarea class="schedule__textarea" 
                  id="message" 
                  name="message">
        </textarea>
        <label class="schedule__label" for="contact">Contact Number</label>
        <input class="schedule__input" type="text" id="contact" name="contact">
        <label class="schedule__label" for="email">Email Address</label>
        <input class="schedule__input" type="text" id="email" name="email">
        <input class="schedule__submit" type="submit" value="next">
      </form>
    </section>
</div>

  <script src="js/validator.js"></script>
  <script>
      var valid = Validators;
      var doc   = document;
      var form  = doc.getElementById('scheduleForm');

      var inputs = {
          evtName:  valid.getNode(doc.getElementById('evtName')),
          date:     valid.getNode(doc.getElementById('date')),
          timezone: valid.getNode(doc.getElementById('timezone')),
          contact:  valid.getNode(doc.getElementById('contact')),
          email:    valid.getNode(doc.getElementById('email'))
      }

      /*
       * For each input, defines a particular Validator function that must 
       * be satisfied to proceed further. 
       */

      inputs.evtName.setConstraint('The Event Name must be a nonempty string ' +
                                   ' of at least of 4 characters');
      inputs.evtName.setValidator(function(elem){

          var value = elem.node.value;

          try { 
              if (valid.isLength(value, 3)) {
                    elem.node.setCustomValidity(elem.constrValue);
              } else {
                    elem.resetCustomValidity();
              }
          } catch (err) {
                  elem.node.setCustomValidity(elem.constrValue);
          }

      });

      inputs.date.setValidator(function(elem){

          var value = elem.node.value;

          try {
            if (!valid.isDate(value)) {
                elem.node.setCustomValidity('Please provide a valid date');
            } else if (valid.isBeforeToday(value)) {
                elem.node.setCustomValidity('The specified date is before today');
            } else {
                elem.resetCustomValidity();
            }
          } catch (err) {
              elem.node.setCustomValidity(elem.constrValue);
          }

      });

      inputs.timezone.setConstraint('Please, select at least one Time-zone');
      inputs.timezone.setValidator(function(elem) {

          var node = elem.node;
          
          if (valid.isEmpty(node.options[node.selectedIndex].value)) {
                node.setCustomValidity(elem.constrValue);
          } else {
                elem.resetCustomValidity();
          }

      });
      
      inputs.contact.setConstraint('Please provide a valid Italian phone number');
      inputs.contact.setValidator(function(elem){

          var value = elem.node.value;

          try {
            if (!valid.isPhoneNumber(value)) {
                elem.node.setCustomValidity(elem.constrValue);
            } else {
                elem.resetCustomValidity();
            }
          } catch (err) {
              elem.node.setCustomValidity(err);
          }

      });

      inputs.email.setConstraint('Please provide a valid email');
      inputs.email.setValidator(function(elem){
        console.log(elem);
          var value = elem.node.value;

          try {
            if (!valid.isEmailAddress(value)) {
                elem.node.setCustomValidity(elem.constrValue);
            }
          } catch (err) {
              elem.node.setCustomValidity(err);
          }

      });


      /* Sets an initial custom validity for every input 
       * All the indicated inputs are not valid by default
       */

      for (var input in inputs) {
        if (inputs.hasOwnProperty(input)) {
          if (inputs[input].constr.isRequired) {
            inputs[input].node.setCustomValidity(inputs[input].constr.constrValue);
          }
          
          // Defines custom event listeners
          inputs[input].node.addEventListener('change', function (event) {

            var constr  = inputs[this.getAttribute('id')].constr;

            constr.setInvalidClass();
            constr.check();

          });
        }
      }


      form.addEventListener('submit', function (event) {

      // Check the inputs validity. If at least one input is invalid, stop
      // the form
      for (var input in inputs) {
          if (inputs.hasOwnProperty(input)) {
              if (!inputs[input].node.validity.valid) {
                  event.preventDefault();
              }
          }
      }

      }, false);
  </script>

</body>
</html>