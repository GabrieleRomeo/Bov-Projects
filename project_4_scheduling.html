<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>
    Modern Developer :: HTML & CSS Project Assignment - Scheduling
  </title>
  <meta name="description" 
        content="Modern Developer :: HTML & CSS Project Assignment - Scheduling">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" 
        href="https://fonts.googleapis.com/css?family=Raleway:400,300italic">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/showcase.css">
  <link rel="stylesheet" href="css/topBar.css">
  <link rel="stylesheet" href="css/project_4_scheduling.css">  
</head>
<body>

  <header class="topbar" role="banner">
    <nav class="topbar__nav" role="navigation">
      <ul class="topbar__nav__list">
        <li class="nav__list__item nav__list__item--home">
          <a class="nav__link" href="index.html" title="Home Page">
            &#8962; Home
          </a>
        </li>        
        <li class="nav__list__item">
          <a  class="nav__link" 
              href="project_4_creditCard.html" 
              title="Next Project">
            Next Project &#8680;
          </a>
        </li>
      </ul>
      <p class="topbar__nav__title">4: Scheduling</p>
    </nav>
  </header>
    
    <!-- PROJECT CONTENT -->

  <div class="scheduling">
    <header class="scheduling__header">
      <h2>Schedule an event</h2>
      <ol class="crumb">
        <li class="crumb__item">
          <a class="crumb__link crumb__link--active active" href="#">
            General
          </a>
        </li>
        <li class="crumb__item">
          <a class="crumb__link" href="#">
            Time proposal
          </a>
        </li>
        <li class="crumb__item">
          <a class="crumb__link" href="#">
            Invite
          </a>
        </li>
      </ol>
    </header>
  <section class="schedule__module">
    <header class="schedule__module__header">
      <picture>
        <img class="header_picture"
             src="images/calendar.png" 
             width="64" 
             height="64" 
             alt="Event Schedule">
      </picture>
      <h2 class="header__heading">Event details</h2>
    </header>
      <form class="schedule__form" action="" method="">
        <p id="evtNameBox">
          <label class="shipping__label" for="evtName">Event Name</label>
          <input class="shipping__input
                        shipping__input--evtName"
                 id="evtName"
                 name="evtName"
                 type="text">
        </p>
        <label class="shipping__label" for="date">Date MM/GG/YY</label>
        <input class="shipping__input" type="text" id="date" name="date">
        <label class="shipping__label" for="time">Time HH:MM</label>
        <input class="shipping__input" type="text" id="time" name="time">
        <label class="shipping__label" for="timezone">Timezone</label>
        <select class="shipping__select" name="timezone" id="timezone">
          <option value="">Select</option>
          <option value="1">Time Zone 1</option>
          <option value="2">Time Zone 2</option>
        </select>
        <label class="shipping__label" for="message">Message</label>
        <textarea class="shipping__textarea" 
                  id="message" 
                  name="message">
        </textarea>
        <label class="shipping__label" for="contact">Contact Number</label>
        <input class="shipping__input" type="text" id="contact" name="contact">
        <label class="shipping__label" for="email">Email Address</label>
        <input class="shipping__input" type="text" id="email" name="email">
        <input class="shipping__submit" type="submit" value="next">
      </form>
    </section>
</div>

  <script src="js/validator.js"></script>
  <script>
      var valid = Validators;
      var doc   = document;
      var form  = doc.getElementById('shippingForm');
      var same  = doc.getElementById('use_B_address');


      var inputs = {
        evtName:  valid.getNode(doc.getElementById('evtName')),
        date:     valid.getNode(doc.getElementById('date')),
        time:     valid.getNode(doc.getElementById('time')),
        timezone: valid.getNode(doc.getElementById('timezone'))
      }

      /*
       * For each input, defines a particular Validator function that must 
       * be satisfied to proceed further. 
       */

      inputs.S_firstName.setValidator(function(){

        var node = this.node;

        if (valid.isEmpty(node.value) && !valid.isLength(node.value, 2)) {
              node.setCustomValidity(this.constrValue);
        } else {
              this.resetCustomValidity();
        }

      });

      inputs.S_lastName.setValidator(function(){

        var node = this.node;

        if (valid.isEmpty(node.value) && !valid.isLength(node.value, 2)) {
              node.setCustomValidity(this.constrValue);
        } else {
              this.resetCustomValidity();
        }

      });
      inputs.S_address.setConstraint('Please specify a valid Shipping Address');
      inputs.S_address.setValidator(function(){

          var node = this.node;

          try {
            if (valid.isEmpty(node.value)) {
                node.setCustomValidity(this.constrValue);
            } else if (!valid.moreWordsThan(node.value, 2)) {
                node.setCustomValidity('A valid address is composed at least ' +
                                       'two words');
            } else {
                this.resetCustomValidity();
            }
          } catch (err) {}

      });

      inputs.S_city.setValidator(function(){

          var node = this.node;

          try { 

            if (valid.isEmpty(node.value)) {
                node.setCustomValidity(this.constrValue);
            } else if (valid.isLength(node.value, 2)) {
                node.setCustomValidity('The minimum length of this field is 3');
            } else {
                this.resetCustomValidity();
            }
          } catch (err) {
                node.setCustomValidity(this.constrValue);
          }

      });

      inputs.S_country.setValidator(function(){

          var node = this.node;

          try {
            if (valid.isEmpty(node.value)) {
                node.setCustomValidity(this.constrValue);
            } else if (valid.isLength(node.value, 2)) {
                node.setCustomValidity('The minimum length of this field is 3');
            } else {
                this.resetCustomValidity();
            }
          } catch (err) {
                node.setCustomValidity(this.constrValue);
          }

      });


      /* Sets an initial custom validity for every input 
       * All the indicated inputs are not valid by default
       */

      for (var input in inputs) {
        if (inputs.hasOwnProperty(input)) {
          inputs[input].node.setCustomValidity(inputs[input].constr.constrValue);
          // Defines custom event listeners
          inputs[input].node.addEventListener('change', function (event) {

            var constr  = inputs[this.getAttribute('id')].constr;
            var billInp = this.getAttribute('id').replace(/S/,'B');
            constr.setInvalidClass();
            constr.check();
            // every time the checkbox is checked, it copies the value of
            // the current 'billing' input into the corresponding shipping input
            if (same.checked) {
              doc.getElementById(billInp).value = constr.node.value;
            }

          });
        }
      }

      // Copies the billing info into the corresponding shipping inputs
      same.addEventListener('change', function (event) {

        var _self = this;

          // Sets the change event for all the radio buttons
          var newObject = Object.keys(inputs).map(function(elem) {

              var billInp = elem.replace(/S/,'B');

              if (_self.checked && !valid.isEmpty(inputs[elem].node.value)) {
                  doc.getElementById(billInp).value = inputs[elem].node.value;
              } else {
                  doc.getElementById(billInp).value = '';
              }
          });

          if (this.checked) {

          }
      });

      form.addEventListener('submit', function (event) {

      // Check the inputs validity. If at least one input is invalid, stop
      // the form
      for (var input in inputs) {
          if (inputs.hasOwnProperty(input)) {
              if (!inputs[input].node.validity.valid) {
                  event.preventDefault();
              }
          }
      }

      }, false);
  </script>

</body>
</html>